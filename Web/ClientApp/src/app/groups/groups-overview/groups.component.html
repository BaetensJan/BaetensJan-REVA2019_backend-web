<div id="header" class="row">
  <h1 class="col-md-2">Groepen</h1>
  <h3 *ngIf="!appStartDateExpired && applicationStartDate">
    De app is actief vanaf:
    <strong>{{applicationStartDate.toLocaleDateString()}}</strong></h3>
</div>

<div class="panel panel-default container-fluid" *ngIf="school" id="app-credentials">
  <div class="panel-body form-inline">
    <label style="font-size: 1.2em;">Optie 1: Met deze logingegevens kunnen de leerlingen zelf groepen aanmaken in de
      app: &nbsp;&nbsp;</label>
    <div class="form-group">
      <label for="schoolLogin">Login</label>
      <input class="form-control" id="schoolLogin" [value]="school.name" disabled>
    </div>
    <div class="form-group">
      <label style="margin-left: 1em;" for="schoolPassword">Paswoord</label>
      <input class="form-control" id="schoolPassword" [value]="school.password" disabled>
    </div>
  </div>
</div>


<div class="panel panel-default">
  <div class="panel-body">
    <label style="margin-bottom: 2em; font-size: 1.2em; margin-left: 1em;" *ngIf="!isAdmin">
      Optie 2: Via deze weg zijn de groepjes al op voorhand aangemaakt en kunnen de leerlingen meteen aan de slag in de
      app.
      <br/>
      Vergeet niet om de logingegevens (login en paswoord) goed bij te houden en te delen met de groepjes!
    </label>


    <!--Search Filter Bar-->
    <div class="row" *ngIf="returnedArray && returnedArray.length > 0">
      <div class="col-md-10">
        <div class="input-group">
      <span class="input-group-addon">Zoekfilter
       </span>
          <input class="form-control" type="text" placeholder="filter" (ngModelChange)="filter($event)"
                 [(ngModel)]="filterValue">
        </div>
      </div>
      <div class="col-md-2">
        <button class="btn btn-info" (click)="filterOnGroupName = !filterOnGroupName">
          <span class="glyphicon glyphicon-check"></span> {{filterOnGroupName ? "Groepsnaam" : "Groepsleden"}}
        </button>
      </div>
    </div>


    <!--Add new group button-->
    <div id="createGroupButton" style="margin-top: 2em;">
      <button (click)="createGroupClicked()" *ngIf="school"
              class="btn btn-success">
        <i [ngClass]="createGroup ? 'glyphicon glyphicon-minus' : 'glyphicon glyphicon-plus'"></i>
        Groep aanmaken
      </button>
    </div>

    <!--Add new group panel-->
    <div *ngIf="createGroup">
      <div class="panel-body">

        <app-update-group
          (submit)="onSubmit()"
        >
        </app-update-group>
      </div>
    </div>


    <!--Overview of groups-->
    <div class="row" *ngIf="returnedArray; else noGroups">
      <div class="col-xs-12 col-12">
        <div class="content-wrapper">
          <accordion [closeOthers]="true">
            <accordion-group *ngFor="let group of returnedArray; let i = index" [isOpen]="i == 0">
              <div accordion-heading>
                <div class="row">
                  <div class="col-md-7 col-sm-6 col-xs-4">
                    <b>
                      {{ isAdmin ? group.schoolName + " " + group.name : group.name }}
                    </b>
                  </div>

                  <div class="col-md-2 col-sm-2 col-xs-4">
                    leden: <span class="badge">{{group.members.length}}</span>
                  </div>

                  <div class="col-md-3 col-sm-4 col-xs-4">
                    <button *ngIf="!isAdmin"
                            (click)="updateGroup(group)" style="margin-right: 0.2em;"
                            class="btn btn-primary">
                      <span class="glyphicon glyphicon-edit"></span>
                    </button>

                    <button (click)="openModal(template, group.id)"
                            class="btn btn-danger">
                      <i class="glyphicon glyphicon-remove"></i>
                    </button>
                  </div>
                </div>
              </div>

              <div class="form-group" *ngIf="school">
                <label for="groepLogin" style="margin-right: 0.5em;">Login groep:</label>
                <p style="font-size: 1.2em;"
                   type="text"
                   class="form-control"
                   id="groepLogin">{{school.name}}<b>.</b>{{group.name}}</p>
              </div>

              <label>Groepsleden:</label>
              <span style="margin-left: 0.4em;"
                    *ngFor="let member of group.members">
                {{member}}
              </span>
            </accordion-group>
          </accordion>
        </div>

        <!--Pagination-->
        <pagination [totalItems]="filteredGroups.length" (pageChanged)="pageChanged($event)"
                    [itemsPerPage]=maxNumberOfGroupsPerPage [(ngModel)]="currentPage"></pagination>
      </div>
    </div>

    <ng-template #noGroups>
      <h4>U heeft nog geen groepen aangemaakt. Zodra u groepen aanmaakt zullen deze hier zichtbaar worden.</h4>
    </ng-template>
  </div>
</div>

<!-- delete member of group modal -->
<ng-template #template>
  <div class="modal-body text-center">
    <p>{{modalMessage}}</p>
    <div class="modal-footer">
      <button type="button" class="btn btn-success pull-left" (click)="decline()">
        Nee
      </button>
      <button type="button" class="btn btn-danger pull-right" (click)="confirm()">
        Ja
      </button>
    </div>
  </div>
</ng-template>

